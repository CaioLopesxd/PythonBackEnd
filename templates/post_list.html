{% extends 'base.html' %} {% block content %}
<link
  rel="stylesheet"
  href="{{ url_for('static', filename='styles/post_list.css') }}"
/>
<div class="container">
  {% for post in posts %}
  <article>
    <div>
      <h2>{{ post.titulo }}</h2>
      <p>{{ post.conteudo }}</p>
      <p class="date">
        Postado em: {{ post.data.strftime('%d/%m/%Y %H:%M:%S') }}
      </p>
    </div>
    <button class="delete" data-id="{{ post._id }}">Delete</button>
  </article>
  {% endfor %}
</div>
<script src="{{ url_for('static', filename='scripts/showMenu.js') }}"></script>
<script>
  document.querySelectorAll(".delete").forEach((button) => {
    button.addEventListener("click", function () {
      const postId = this.getAttribute("data-id");
      fetch("/delete_post", {
        method: "POST",
        headers: {
          "Content-Type": "application/x-www-form-urlencoded",
        },
        body: new URLSearchParams({
          id: postId,
        }),
      })
        .then((response) => response.json())
        .then((data) => {
          if (data.success) {
            location.reload();
          } else {
            alert("Erro ao deletar o post.");
          }
        });
    });
  });
</script>
{% endblock %}
